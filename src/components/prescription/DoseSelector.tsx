import { useState, useEffect } from "react";
import { Check, ChevronsUpDown } from "lucide-react";
import { Command, CommandEmpty, CommandGroup, CommandInput, CommandItem, CommandList } from "@/components/ui/command";
import { Popover, PopoverContent, PopoverTrigger } from "@/components/ui/popover";
import { Button } from "@/components/ui/button";
import { supabase } from "@/integrations/supabase/client";
import { cn } from "@/lib/utils";

interface DosageForm {
  id: number;
  name: string;
}

interface DoseSelectorProps {
  value: string;
  onChange: (dose: string) => void;
  durationValue?: string;
  onDurationChange?: (duration: string) => void;
}

const tabletDoses = [
  "‡ßß+‡ß¶+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß+‡ßß+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß¶+‡ß¶+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß+‡ß¶+‡ß¶ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß¶+‡ßß+‡ß¶ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß+‡ßß+‡ß¶ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß¶+‡ßß+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß+‡ß¶+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá)",
  "‡ßß+‡ßß+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá)",
  "‡ß¶+‡ß¶+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá)",
  "‡ßß+‡ß¶+‡ß¶ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá)",
  "‡ß¶+‡ßß+‡ß¶ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá)",
  "‡ßß+‡ßß+‡ß¶ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá)",
  "‡ß¶+‡ßß+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá)",
  "‡ßß/‡ß®+‡ß¶+‡ßß/‡ß® (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß/‡ß®+‡ßß/‡ß®+‡ßß/‡ß® (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß/‡ß™+‡ß¶+‡ßß/‡ß™ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß/‡ß™+‡ßß/‡ß™+‡ßß/‡ß™ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß®+‡ß¶+‡ß® (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß®+‡ß®+‡ß® (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß+‡ß¶+‡ß¶+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß+‡ßß+‡ßß+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß¶+‡ß¶+‡ßß+‡ß¶ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶æ‡¶≤‡ßá ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶™‡ßá‡¶ü‡ßá",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶æ‡¶§‡ßá ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá",
  "‡ß¨ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶™‡¶∞",
  "‡ßÆ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶™‡¶∞",
  "‡ßß‡ß® ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶™‡¶∞",
  "‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß™ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶Ø‡¶º ‡ßß‡¶ü‡¶ø",
];

const syrupDoses = [
  "‡ßß ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß® ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß® ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß/‡ß® ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß/‡ß® ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ß´ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ß´ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß‡ß¶ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß‡ß¶ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞ (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá)",
  "‡ßß‡ß´ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß®.‡ß´ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß®.‡ß´ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ (‡¶∞‡¶æ‡¶§‡ßá)",
  "‡ß® ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ (‡¶∞‡¶æ‡¶§‡ßá)",
  "‡ßß ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ (‡¶∏‡¶ï‡¶æ‡¶≤‡ßá)",
  "‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß¨ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶Ø‡¶º ‡ßß ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö",
  "‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßÆ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶Ø‡¶º ‡ßß ‡¶ö‡¶æ ‡¶ö‡¶æ‡¶Æ‡¶ö",
];

const dropDoses = [
  "‡ßß ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß™ ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß™ ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß® ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶Ø‡¶º",
  "‡ßß ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ö‡ßã‡¶ñ‡ßá ‡¶∞‡¶æ‡¶§‡ßá ‡¶ò‡ßÅ‡¶Æ‡¶æ‡¶®‡ßã‡¶∞ ‡¶Ü‡¶ó‡ßá",
  "‡ßß ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ï‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ï‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ï‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ß© ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ï‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ß© ‡¶°‡ßç‡¶∞‡¶™ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
];

const injectionDoses = [
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶Ü‡¶á.‡¶è‡¶Æ ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶Ü‡¶á.‡¶è‡¶Æ ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶≠‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶≠‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶≠‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶≠‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶Ü‡¶á.‡¶è‡¶Æ ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡¶∏‡¶æ‡¶¨‡¶ï‡¶ø‡¶â‡¶ü‡ßá‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∏ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ",
  "‡¶∏‡¶æ‡¶¨‡¶ï‡¶ø‡¶â‡¶ü‡ßá‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∏ ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡¶∏‡¶æ‡¶¨‡¶ï‡¶ø‡¶â‡¶ü‡ßá‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∏ ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶á‡¶®‡¶´‡¶ø‡¶â‡¶∂‡¶® ‡ßÆ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶™‡¶∞",
  "‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶á‡¶®‡¶´‡¶ø‡¶â‡¶∂‡¶® ‡ßß‡ß® ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶™‡¶∞",
  "‡¶Ü‡¶á.‡¶≠‡¶ø ‡¶¨‡ßã‡¶≤‡¶æ‡¶∏ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ",
];

const creamDoses = [
  "‡¶Ü‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶Ü‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶Ü‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶Ü‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß™ ‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶™‡¶æ‡¶§‡¶≤‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶™‡¶æ‡¶§‡¶≤‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶∞‡¶æ‡¶§‡ßá ‡¶ò‡ßÅ‡¶Æ‡¶æ‡¶®‡ßã‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶∏‡¶ï‡¶æ‡¶≤‡ßá ‡¶ì ‡¶∞‡¶æ‡¶§‡ßá ‡¶≤‡¶æ‡¶ó‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡¶∏‡ßç‡¶®‡¶æ‡¶®‡ßá‡¶∞ ‡¶™‡¶∞‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
];

const inhalerDoses = [
  "‡ß® ‡¶™‡¶æ‡¶´ ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶™‡¶æ‡¶´ ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶™‡¶æ‡¶´ ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶™‡¶æ‡¶´ ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶™‡¶æ‡¶´ ‡¶¶‡¶ø‡¶®‡ßá ‡ß™ ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶™‡¶æ‡¶´ ‡¶¶‡¶ø‡¶®‡ßá ‡ß™ ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶™‡¶æ‡¶´ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß¨ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶Ø‡¶º",
  "‡ß® ‡¶™‡¶æ‡¶´ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ",
  "‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ (‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßÆ ‡¶™‡¶æ‡¶´/‡¶¶‡¶ø‡¶®)",
];

const nebuliserDoses = [
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡ß¨ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶™‡¶∞",
  "‡ßß ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßÅ‡¶≤ ‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡ßÆ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶™‡¶∞",
  "‡ß® ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ",
];

const suppositoryDoses = [
  "‡ßß‡¶ü‡¶ø ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶≤ ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß‡¶ü‡¶ø ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶≤ ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß‡¶ü‡¶ø ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶≤ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ",
  "‡ßß‡¶ü‡¶ø ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶≤ ‡¶ú‡ßç‡¶¨‡¶∞ ‡¶π‡¶≤‡ßá",
  "‡ßß‡¶ü‡¶ø ‡¶≠‡ßç‡¶Ø‡¶æ‡¶ú‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶æ‡¶§‡ßá",
  "‡ßß‡¶ü‡¶ø ‡¶≠‡ßç‡¶Ø‡¶æ‡¶ú‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
];

const sprayDoses = [
  "‡ßß ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡ßá ‡¶Æ‡ßÅ‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ß® ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡ßá ‡¶Æ‡ßÅ‡¶ñ‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
];

const patchDoses = [
  "‡ßß‡¶ü‡¶ø ‡¶™‡ßç‡¶Ø‡¶æ‡¶ö ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß‡¶ü‡¶ø ‡¶™‡ßç‡¶Ø‡¶æ‡¶ö ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß®‡ß™ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶Ø‡¶º ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá",
  "‡ßß‡¶ü‡¶ø ‡¶™‡ßç‡¶Ø‡¶æ‡¶ö ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß‡¶ü‡¶ø ‡¶™‡ßç‡¶Ø‡¶æ‡¶ö ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
];

const sachetsAndPowderDoses = [
  "‡ßß ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∂‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∂‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∂‡ßá ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∂‡ßá ‡¶∞‡¶æ‡¶§‡ßá ‡¶ò‡ßÅ‡¶Æ‡¶æ‡¶®‡ßã‡¶∞ ‡¶Ü‡¶ó‡ßá",
  "‡ßß ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü ‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü ‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡ßß ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü ‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
];

const insulinDoses = [
  "‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶∞‡¶ï‡ßç‡¶§‡ßá‡¶∞ ‡¶∂‡¶∞‡ßç‡¶ï‡¶∞‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ",
  "‡¶∏‡¶ï‡¶æ‡¶≤‡ßá __ ‡¶á‡¶â‡¶®‡¶ø‡¶ü, ‡¶∞‡¶æ‡¶§‡ßá __ ‡¶á‡¶â‡¶®‡¶ø‡¶ü",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ __ ‡¶á‡¶â‡¶®‡¶ø‡¶ü",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ __ ‡¶á‡¶â‡¶®‡¶ø‡¶ü",
  "‡¶∏‡¶ï‡¶æ‡¶≤‡ßá __ ‡¶á‡¶â‡¶®‡¶ø‡¶ü",
  "‡¶∞‡¶æ‡¶§‡ßá __ ‡¶á‡¶â‡¶®‡¶ø‡¶ü",
];

const generalDoses = [
  "‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ (‡¶∏‡¶ï‡¶æ‡¶≤‡ßá)",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞ (‡¶∞‡¶æ‡¶§‡ßá)",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞ (‡¶∏‡¶ï‡¶æ‡¶≤ ‡¶ì ‡¶∞‡¶æ‡¶§)",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡¶¶‡¶ø‡¶®‡ßá ‡ß™ ‡¶¨‡¶æ‡¶∞",
  "‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ß® ‡¶¨‡¶æ‡¶∞",
  "‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ß© ‡¶¨‡¶æ‡¶∞",
  "‡¶Æ‡¶æ‡¶∏‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß® ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ßß ‡¶¨‡¶æ‡¶∞",
  "‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ",
  "‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶™‡ßá‡¶ü‡ßá",
  "‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá",
  "‡¶ò‡ßÅ‡¶Æ‡¶æ‡¶®‡ßã‡¶∞ ‡¶Ü‡¶ó‡ßá",
  "‡¶∏‡¶ï‡¶æ‡¶≤‡ßá ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶™‡ßá‡¶ü‡ßá",
  "‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡ß©‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶Ü‡¶ó‡ßá",
  "‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡ßß ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞‡ßá",
];

const DoseSelector = ({ value, onChange }: DoseSelectorProps) => {
  const [open, setOpen] = useState(false);
  const [dosageForms, setDosageForms] = useState<DosageForm[]>([]);
  const [customDose, setCustomDose] = useState("");

  useEffect(() => {
    const fetchDosageForms = async () => {
      const { data } = await supabase
        .from("dosage_forms")
        .select("id, name")
        .order("name")
        .limit(20);
      
      if (data) setDosageForms(data);
    };
    
    fetchDosageForms();
  }, []);

  return (
    <Popover open={open} onOpenChange={setOpen}>
      <PopoverTrigger asChild>
        <Button
          variant="outline"
          role="combobox"
          aria-expanded={open}
          className="w-full justify-between font-normal text-left h-auto py-2 px-3"
          style={{ 
            fontSize: "14px",
            fontWeight: value ? 600 : 400,
            fontStyle: value ? "normal" : "italic",
            color: value ? "#000" : "#999",
            paddingLeft: "15px"
          }}
        >
          {value || "‚Üí ‡¶°‡ßã‡¶ú: Select dose..."}
          <ChevronsUpDown className="ml-2 h-4 w-4 shrink-0 opacity-50" />
        </Button>
      </PopoverTrigger>
      <PopoverContent className="w-[450px] p-0 bg-white dark:bg-gray-800 z-[9999] shadow-lg border" align="start">
        <Command className="bg-white dark:bg-gray-800">
          <div className="p-4 border-b border-gray-200 dark:border-gray-700 bg-blue-50 dark:bg-blue-900/20">
            <label className="block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2">
              üìù ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶°‡ßã‡¶ú ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®
            </label>
            <input
              type="text"
              placeholder="‡¶Ø‡ßá‡¶Æ‡¶®‡¶É ‡ßß+‡ß¶+‡ßß (‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá ‡ß≠ ‡¶¶‡¶ø‡¶®)"
              className="w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              value={customDose}
              onChange={(e) => setCustomDose(e.target.value)}
              onKeyDown={(e) => {
                if (e.key === 'Enter' && customDose.trim()) {
                  onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${customDose.trim()}`);
                  setCustomDose("");
                  setOpen(false);
                }
              }}
            />
            {customDose.trim() && (
              <Button
                size="sm"
                className="w-full mt-2 bg-blue-600 hover:bg-blue-700 text-white"
                onClick={() => {
                  onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${customDose.trim()}`);
                  setCustomDose("");
                  setOpen(false);
                }}
              >
                ‚úì ‡¶è‡¶á ‡¶°‡ßã‡¶ú ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
              </Button>
            )}
          </div>
          <CommandInput placeholder="‡¶°‡ßã‡¶ú ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." className="border-b" />
          <CommandList className="max-h-[400px]">
            <CommandEmpty>‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßã‡¶ú ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</CommandEmpty>
            
            <CommandGroup heading="üíä ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨‡¶≤‡ßá‡¶ü/‡¶ï‡ßç‡¶Ø‡¶æ‡¶™‡¶∏‡ßÅ‡¶≤">
              {tabletDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="ü•Ñ ‡¶∏‡¶ø‡¶∞‡¶æ‡¶™">
              {syrupDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üíß ‡¶°‡ßç‡¶∞‡¶™ (‡¶ö‡ßã‡¶ñ/‡¶ï‡¶æ‡¶®/‡¶®‡¶æ‡¶ï)">
              {dropDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üíâ ‡¶á‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶®/‡¶Ü‡¶á.‡¶≠‡¶ø">
              {injectionDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üß¥ ‡¶ï‡ßç‡¶∞‡¶ø‡¶Æ/‡¶Ö‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü">
              {creamDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üå¨Ô∏è ‡¶á‡¶®‡¶π‡ßá‡¶≤‡¶æ‡¶∞">
              {inhalerDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üå´Ô∏è ‡¶®‡ßá‡¶¨‡ßÅ‡¶≤‡¶æ‡¶á‡¶ú‡¶æ‡¶∞">
              {nebuliserDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üî∫ ‡¶∏‡¶æ‡¶™‡ßã‡¶ú‡¶ø‡¶ü‡¶∞‡¶ø">
              {suppositoryDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üí® ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡ßá">
              {sprayDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üìã ‡¶™‡ßç‡¶Ø‡¶æ‡¶ö">
              {patchDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üì¶ ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∂‡ßá/‡¶™‡¶æ‡¶â‡¶°‡¶æ‡¶∞">
              {sachetsAndPowderDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="üíâ ‡¶á‡¶®‡¶∏‡ßÅ‡¶≤‡¶ø‡¶®">
              {insulinDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>

            <CommandGroup heading="‚è∞ ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£">
              {generalDoses.map((dose) => (
                <CommandItem
                  key={dose}
                  value={dose}
                  onSelect={() => {
                    onChange(`‚Üí ‡¶°‡ßã‡¶ú: ${dose}`);
                    setOpen(false);
                  }}
                >
                  <Check
                    className={cn(
                      "mr-2 h-4 w-4",
                      value.includes(dose) ? "opacity-100" : "opacity-0"
                    )}
                  />
                  {dose}
                </CommandItem>
              ))}
            </CommandGroup>
          </CommandList>
        </Command>
      </PopoverContent>
    </Popover>
  );
};

export default DoseSelector;
